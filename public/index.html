<!doctype html><html lang='en'><head><meta charset='utf-8'><meta name='viewport' content='width=device-width,initial-scale=1'><title>UAV Flight Check</title><link rel='stylesheet' href='https://unpkg.com/leaflet@1.9.4/dist/leaflet.css'/><style>body,html{margin:0;padding:0;height:100%;font-family:system-ui,-apple-system,BlinkMacSystemFont,'Segoe UI',Roboto,sans-serif;background:#0A1A2F;color:#fff;overflow:hidden}#loading{position:fixed;top:0;left:0;right:0;bottom:0;display:flex;align-items:center;justify-content:center;background:#0A1A2F;z-index:1000;font-size:1.2em;transition:opacity .5s ease}#map{height:100%;width:100%}header{position:absolute;top:0;width:100%;text-align:center;padding:10px;background:rgba(0,0,0,0.4);z-index:500}footer{position:absolute;bottom:0;width:100%;display:flex;justify-content:space-around;background:rgba(0,0,0,0.6);z-index:500;padding:5px 0}.tab{flex:1;text-align:center;padding:10px;cursor:pointer}.panel{position:absolute;bottom:-50%;left:0;width:100%;background:#0A1A2F;transition:bottom .4s ease,opacity .4s ease;opacity:0;padding:15px;z-index:400}.panel.active{bottom:50px;opacity:1}.score{font-size:2em;text-align:center;margin-top:10px;transition:color .5s ease}.toggle{position:absolute;top:10px;right:10px;background:#00AEEF;color:#fff;border:none;padding:5px 10px;border-radius:4px;cursor:pointer}</style></head><body><div id='loading'>Loadingâ€¦</div><header><h3>UAV Flight Check</h3><button class='toggle' id='unitToggle'>Â°C</button></header><div id='map'></div><footer><div class='tab' data-panel='weather'>â˜€</div><div class='tab' data-panel='wind'>ðŸŒ¬</div><div class='tab' data-panel='score'>âœ…</div></footer><div class='panel' id='panel-weather'></div><div class='panel' id='panel-wind'></div><div class='panel' id='panel-score'></div><script src='https://unpkg.com/leaflet@1.9.4/dist/leaflet.js'></script><script>const map=L.map('map').setView([0,0],2);L.tileLayer('https://{s}.tile.openstreetmap.org/{z}/{x}/{y}.png',{attribution:'Â© OpenStreetMap'}).addTo(map);const loading=document.getElementById('loading');navigator.geolocation.getCurrentPosition(async pos=>{const{latitude,longitude}=pos.coords;map.setView([latitude,longitude],10);const weather=await fetch(`/api/weather?lat=${latitude}&lon=${longitude}`).then(r=>r.json());const kp=await fetch(`/api/geomagnetic`).then(r=>r.json());const sat=await fetch(`/api/satellite`).then(r=>r.json());const current=weather.current_weather;const temp=current.temperature;const wind=current.windspeed;const cloud=weather.hourly.cloudcover[0];const precip=weather.hourly.precipitation_probability[0];const visibility=(weather.hourly.visibility[0]/1000);const scoreResp=await fetch('/api/score',{method:'POST',headers:{'Content-Type':'application/json'},body:JSON.stringify({wind,visibility,precipitation:precip,kp:kp.kp,cloud})}).then(r=>r.json());const score=scoreResp.score;document.getElementById('panel-weather').innerHTML=`<b>Temperature:</b> ${temp}Â°<br><b>Clouds:</b> ${cloud}%<br><b>Precip:</b> ${precip}%<br><b>Visibility:</b> ${visibility} km`;document.getElementById('panel-wind').innerHTML=`<b>Wind:</b> ${wind} m/s<br><b>Kp index:</b> ${kp.kp}<br><b>Satellite:</b> ${sat.coverage}%`;const scoreDiv=document.createElement('div');scoreDiv.className='score';document.getElementById('panel-score').innerHTML='';document.getElementById('panel-score').appendChild(scoreDiv);animateScore(scoreDiv,score);loading.style.opacity='0';setTimeout(()=>loading.style.display='none',500);});function animateScore(el,target){let start=0;const duration=1500;const startTime=performance.now();function update(now){const progress=Math.min((now-startTime)/duration,1);const val=Math.floor(progress*target);const hue=val*1.2;el.style.color=`hsl(${hue},100%,50%)`;el.textContent=val;if(progress<1)requestAnimationFrame(update);}requestAnimationFrame(update);}document.querySelectorAll('.tab').forEach(t=>t.onclick=()=>{document.querySelectorAll('.panel').forEach(p=>p.classList.remove('active'));document.getElementById('panel-'+t.dataset.panel).classList.toggle('active');});</script></body></html>
